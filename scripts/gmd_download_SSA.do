* Social Sustainability Global Database v2.0
* consultant: Omar Alburqueque Ch√°vez
* contact: oalburquequechav@worldbank.org
* last update: July 7th, 2023
* original data source: Datalibweb

clear all
set more off

* directory macros
global raw_data "${ssgd_v2_userpath}\SSGD v2.0\raw_data"

cd "$raw_data"

* -------------------------- *
* SSA region data processing *
* -------------------------- *

* country macro
global countries "AGO BEN BWA BFA BDI CPV CMR CAF TCD COM COD COG CIV SWZ ETH GAB GMB GHA GIN GNB KEN LSO LBR MDG MWI MLI MRT MUS MOZ NAM NER NGA RWA STP SEN SYC SLE ZAF SSD SDN TZA TGO UGA ZMB ZWE"
* periods macro (for each country)
local periods_AGO = "2008"
local periods_AGO = "2018"
local periods_BEN = "2015 2018"
local periods_BWA = "2015"
local periods_BFA = "2014 2018"
local periods_BDI = "2006 2013"
local periods_CPV = "2015"
local periods_CMR = "2014"
local periods_CAF = "2008"
local periods_TCD = "2011 2018"
local periods_COM = "2013"
local periods_COD = "2012"
local periods_COG = "2011"
local periods_CIV = "2015 2018"
local periods_SWZ = "2016"
local periods_ETH = "2015"
local periods_GAB = "2017"
local periods_GMB = "2015 2020"
local periods_GHA = "2016"
local periods_GIN = "2012 2018"
local periods_GNB = "2010 2018"
local periods_KEN = "2015"
local periods_LSO = "2017"
local periods_LBR = "2016"
local periods_MDG = "2012"
local periods_MWI = "2016 2019"
local periods_MLI = "2009 2018"
local periods_MRT = "2014"
local periods_MUS = "2012 2017"
local periods_MOZ = "2014"
local periods_NAM = "2015"
local periods_NER = "2014 2018"
local periods_NGA = "2018"
local periods_RWA = "2016"
local periods_STP = "2017"
local periods_SEN = "2011 2018"
local periods_SYC = "2013 2018"
local periods_SLE = "2018"
local periods_ZAF = "2014"
local periods_SSD = "2016"
local periods_SDN = "2014"
local periods_TZA = "2018"
local periods_TGO = "2015 2018"
local periods_UGA = "2016 2019"
local periods_ZMB = "2015"
local periods_ZWE = "2017 2019"
* survey macros (for each country and period)
local survey_AGO = "IDREA"
local survey_BEN = "EMICOV"
local survey_BWA = "BMTHS"
local survey_BFA = "EMC"
local survey_BDI = "ECVMB"
local survey_CPV = "IDRF"
local survey_CMR = "ECAM-IV"
local survey_CAF = "ECASEB"
local survey_TCD = "ECOSIT-III"
local survey_COM = "EESIC"
local survey_COD = "E123"
local survey_COG = "ECOM"
local survey_CIV = "ENV"
local survey_SWZ = "HIES"
local survey_ETH = "HICES"
local survey_GAB = "EGEP"
local survey_GMB = "IHS"
local survey_GHA = "GLSS-VII"
local survey_GIN = "ELEP"
local survey_GNB = "ILAP-II"
local survey_KEN = "IHBS"
local survey_LSO = "CMSHBS"
local survey_LBR = "HIES"
local survey_MDG = "ENSOMD"
local survey_MWI = "IHS-IV"
local survey_MLI = "ELIM"
local survey_MRT = "EPCV"
local survey_MUS = "HBS"
local survey_MOZ = "IOF"
local survey_NAM = "NHIES"
local survey_NER = "ECVMA"
local survey_NGA = "LSS"
local survey_RWA = "EICV-V"
local survey_STP = "IOF"
local survey_SEN = "ESPS-II"
local survey_SYC = "HBS"
local survey_SLE = "SLIHS"
local survey_ZAF = "LCS"
local survey_SSD = "HFS-W3"
local survey_SDN = "NBHS"
local survey_TZA = "HBS"
local survey_TGO = "QUIBB"
local survey_UGA = "UNHS"
local survey_ZMB = "LCMS-VII"
local survey_ZWE = "PICES"
foreach x in $countries{
	foreach y of local periods_`x'{
		local survey_`x'_`y' = "`survey_`x''"
	}
}
* version M
foreach x in $countries{
	foreach y of local periods_`x'{
		local vm_`x'_`y' = "01"
	}
}
local vm_ZAF_2014 = "02"
local vm_GMB_2020 = "02"

* version A
local va_AGO_2008 = "02"
local va_AGO_2018 = "01"
local va_BEN_2015 = "03"
local va_BEN_2018 = "02"
local va_BWA_2015 = "03"
local va_BFA_2014 = "04"
local va_BFA_2018 = "02"
local va_BDI_2006 = "01"
local va_BDI_2013 = "04"
local va_CPV_2015 = "01"
local va_CMR_2014 = "03"
local va_CAF_2008 = "05"
local va_TCD_2011 = "03"
local va_TCD_2018 = "02"
local va_COM_2013 = "07"
local va_COD_2012 = "05"
local va_COG_2011 = "04"
local va_CIV_2015 = "03"
local va_CIV_2018 = "02"
local va_SWZ_2016 = "01"
local va_ETH_2015 = "04"
local va_GAB_2017 = "04"
local va_GMB_2015 = "04"
local va_GMB_2020 = "02"
local va_GHA_2016 = "03"
local va_GIN_2012 = "03"
local va_GIN_2018 = "02"
local va_GNB_2010 = "01"
local va_GNB_2018 = "02"
local va_KEN_2015 = "04"
local va_LSO_2017 = "02"
local va_LBR_2016 = "05"
local va_MDG_2012 = "06"
local va_MWI_2016 = "03"
local va_MWI_2019 = "01"
local va_MLI_2009 = "02"
local va_MLI_2018 = "02"
local va_MRT_2014 = "04"
local va_MUS_2012 = "03"
local va_MUS_2017 = "02"
local va_MOZ_2014 = "04"
local va_NAM_2015 = "04"
local va_NER_2014 = "02"
local va_NER_2018 = "01"
local va_NGA_2018 = "02"
local va_RWA_2016 = "04"
local va_STP_2017 = "01"
local va_SEN_2011 = "02"
local va_SEN_2018 = "02"
local va_SYC_2013 = "02"
local va_SYC_2018 = "01"
local va_SLE_2018 = "01"
local va_ZAF_2014 = "02"
local va_SSD_2016 = "01"
local va_SDN_2014 = "02"
local va_TZA_2018 = "01"
local va_TGO_2015 = "02"
local va_TGO_2018 = "02"
local va_UGA_2016 = "06"
local va_UGA_2019 = "01"
local va_ZMB_2015 = "04"
local va_ZWE_2017 = "01"
local va_ZWE_2019 = "01"

* corrections
local survey_AGO_2008 = "IBEP-MICS"
local survey_BEN_2018 = "EHCVM"
local survey_BDI_2006 = "QUIBB"
local survey_BFA_2018 = "EHCVM"
local survey_TCD_2018 = "EHCVM"
local survey_CIV_2018 = "EHCVM"
local survey_GIN_2018 = "EHCVM"
local survey_GNB_2018 = "EHCVM"
local survey_MLI_2018 = "EHCVM"
local survey_MWI_2019 = "IHS-V"
local survey_NER_2018 = "EHCVM"
local survey_SEN_2018 = "EHCVM"
local survey_TGO_2018 = "EHCVM"
foreach x in $countries{
	foreach y of local periods_`x'{
		dlw, coun(`x') y(`y') t(GMD) mod(ALL) verm(`vm_`x'_`y'') vera(`va_`x'_`y'') sur(`survey_`x'_`y'') clear
		di "country `x' and period `y' data processing succeeded"
		save "$raw_data\gmd\ssa\GMD_`x'_`y'.dta", replace
	}
}