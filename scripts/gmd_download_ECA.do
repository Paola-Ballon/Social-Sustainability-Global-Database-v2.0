* Social Sustainability Global Database v2.0
* consultant: Omar Alburqueque Ch√°vez
* contact: oalburquequechav@worldbank.org
* last update: July 7th, 2023
* original data source: Datalibweb

/*
Issues:
	- The following countries require special request to access data: SLV NIC HND GTM DOM
	- The following countries have problems with their data: LCA
		* Cannot open the data file
*/

clear all
set more off

* directory macros
global raw_data "${ssgd_v2_userpath}\SSGD v2.0\raw_data"

cd "$raw_data"

* -------------------------- *
* ECA region data processing *
* -------------------------- *

* country macro
global countries "ALB ARM AUT AZE BEL BGR BIH BLR CHE CYP CZE DEU DNK ESP EST FIN FRA GBR GEO GRC HRV HUN IRL ISL ITA KAZ KGZ XKX LTU LUX LVA MDA MKD MNE NLD NOR POL PRT ROU RUS SRB SVK SVN SWE TJK TUR UKR"
* periods macro (for each country)
local periods_ALB = "2014 2017 2018 2020"
local periods_ARM = "2014 2018 2019 2020 2021"
local periods_AUT = "2015 2018 2019 2020 2021"
local periods_AZE = "2005"
local periods_BEL = "2015 2018 2019 2020 2021"
local periods_BGR = "2015 2018 2019 2020 2021"
local periods_BIH = "2011"
local periods_BLR = "2015 2018 2019 2020"
local periods_CHE = "2015 2018 2019"
local periods_CYP = "2015 2018 2019 2020 2021"
local periods_CZE = "2015 2018 2019 2020 2021"
local periods_DEU = "2012"
local periods_DNK = "2015 2018 2019 2020 2021"
local periods_ESP = "2015 2018 2019 2020 2021"
local periods_EST = "2015 2018 2019 2020 2021"
local periods_FIN = "2015 2018 2019 2020 2021"
local periods_FRA = "2015 2018 2019 2020 2021"
local periods_GBR = "2015 2018"
local periods_GEO = "2015 2018 2019 2020 2021"
local periods_GRC = "2015 2018 2019 2020 2021"
local periods_HRV = "2015 2018 2019 2020 2021"
local periods_HUN = "2015 2018 2019 2020 2021"
local periods_IRL = "2015 2018 2019 2020 2021"
local periods_ISL = "2015 2018"
local periods_ITA = "2015 2018 2019 2020 2021"
local periods_KAZ = "2015 2018"
local periods_KGZ = "2015 2018 2019 2020"
local periods_XKX = "2014 2017"
local periods_LTU = "2015 2018 2019 2020 2021"
local periods_LUX = "2015 2018 2019 2020 2021"
local periods_LVA = "2015 2018 2019 2020 2021"
local periods_MDA = "2015 2018 2019 2021"
local periods_MKD = "2015 2018 2019 2020"
local periods_MNE = "2014 2017 2018 2019"
local periods_NLD = "2015 2018 2019 2020 2021"
local periods_NOR = "2015 2018 2019 2020"
local periods_POL = "2015 2018 2019 2020"
local periods_PRT = "2015 2018 2019 2020 2021"
local periods_ROU = "2015 2018 2019 2020 2021"
local periods_RUS = "2015 2018 2019 2020"
local periods_SRB = "2015 2018 2019 2020 2021"
local periods_SVK = "2015 2018 2019 2020"
local periods_SVN = "2015 2018 2019 2020 2021"
local periods_SWE = "2015 2018 2019 2020 2021"
local periods_TJK = "2015"
local periods_TUR = "2015 2018 2019"
local periods_UKR = "2015 2018 2019 2020"
* survey macros (for each country and period)
local survey_ALB = "HBS"
local survey_ARM = "ILCS"
local survey_AUT = "EU-SILC"
local survey_AZE = "HBS"
local survey_BEL = "EU-SILC"
local survey_BGR = "EU-SILC"
local survey_BIH = "HBS"
local survey_BLR = "HHS"
local survey_CHE = "EU-SILC"
local survey_CYP = "EU-SILC"
local survey_CZE = "EU-SILC"
local survey_DEU = "EU-SILC"
local survey_DNK = "EU-SILC"
local survey_ESP = "EU-SILC"
local survey_EST = "EU-SILC"
local survey_FIN = "EU-SILC"
local survey_FRA = "EU-SILC"
local survey_GBR = "EU-SILC"
local survey_GEO = "HIS"
local survey_GRC = "EU-SILC"
local survey_HRV = "EU-SILC"
local survey_HUN = "EU-SILC"
local survey_IRL = "EU-SILC"
local survey_ISL = "EU-SILC"
local survey_ITA = "EU-SILC"
local survey_KAZ = "HBS"
local survey_KGZ = "KIHS"
local survey_XKX = "HBS"
local survey_LTU = "EU-SILC"
local survey_LUX = "EU-SILC"
local survey_LVA = "EU-SILC"
local survey_MDA = "HBS"
local survey_MKD = "SILC-C"
local survey_MNE = "SILC-C"
local survey_NLD = "EU-SILC"
local survey_NOR = "EU-SILC"
local survey_POL = "HBS" // needs a correction
local survey_PRT = "EU-SILC"
local survey_ROU = "EU-SILC"
local survey_RUS = "HBS"
local survey_SRB = "HBS" // needs a correction
local survey_SVK = "EU-SILC"
local survey_SVN = "EU-SILC"
local survey_SWE = "EU-SILC"
local survey_TJK = "HSITAFIEN"
local survey_TUR = "HICES"
local survey_UKR = "HLCS"
foreach x in $countries{
	foreach y of local periods_`x'{
		local survey_`x'_`y' = "`survey_`x''"
	}
}
* version M
foreach x in $countries{
	foreach y of local periods_`x'{
		local vm_`x'_`y' = "01"
	}
}
local vm_KGZ_2015 = "02"
local vm_KGZ_2019 = "02"
local vm_KGZ_2020 = "02"

* version A
local va_ALB_2014 = "01"
local va_ALB_2017 = "02"
local va_ALB_2018 = "01"
local va_ALB_2019 = "01"
local va_ALB_2020 = "01"
local va_ARM_2014 = "03"
local va_ARM_2018 = "02"
local va_ARM_2019 = "03"
local va_ARM_2020 = "02"
local va_ARM_2021 = "01"
local va_AUT_2015 = "04"
local va_AUT_2018 = "01"
local va_AUT_2019 = "02"
local va_AUT_2020 = "01"
local va_AUT_2021 = "01"
local va_AZE_2005 = "03"
local va_BEL_2015 = "04"
local va_BEL_2018 = "02"
local va_BEL_2019 = "01"
local va_BEL_2020 = "01"
local va_BEL_2021 = "01"
local va_BGR_2015 = "04"
local va_BGR_2018 = "01"
local va_BGR_2019 = "01"
local va_BGR_2020 = "01"
local va_BGR_2021 = "01"
local va_BIH_2011 = "04"
local va_BLR_2015 = "04"
local va_BLR_2018 = "02"
local va_BLR_2019 = "01"
local va_BLR_2020 = "01"
local va_CHE_2015 = "04"
local va_CHE_2018 = "01"
local va_CHE_2019 = "01"
local va_CYP_2015 = "04"
local va_CYP_2018 = "01"
local va_CYP_2019 = "01"
local va_CYP_2020 = "01"
local va_CYP_2021 = "01"
local va_CZE_2015 = "04"
local va_CZE_2018 = "01"
local va_CZE_2019 = "01"
local va_CZE_2020 = "01"
local va_CZE_2021 = "01"
local va_DEU_2012 = "02"
local va_DNK_2015 = "04"
local va_DNK_2018 = "03"
local va_DNK_2019 = "01"
local va_DNK_2020 = "01"
local va_DNK_2021 = "01"
local va_ESP_2015 = "04"
local va_ESP_2018 = "01"
local va_ESP_2019 = "01"
local va_ESP_2020 = "01"
local va_ESP_2021 = "01"
local va_EST_2015 = "04"
local va_EST_2018 = "01"
local va_EST_2019 = "01"
local va_EST_2020 = "01"
local va_EST_2021 = "01"
local va_FIN_2015 = "04"
local va_FIN_2018 = "01"
local va_FIN_2019 = "01"
local va_FIN_2020 = "01"
local va_FIN_2021 = "01"
local va_FRA_2015 = "04"
local va_FRA_2018 = "01"
local va_FRA_2019 = "01"
local va_FRA_2020 = "01"
local va_FRA_2021 = "01"
local va_GBR_2015 = "04"
local va_GBR_2018 = "03"
local va_GEO_2015 = "04"
local va_GEO_2018 = "04"
local va_GEO_2019 = "02"
local va_GEO_2020 = "01"
local va_GEO_2021 = "01"
local va_GRC_2015 = "04"
local va_GRC_2018 = "01"
local va_GRC_2019 = "01"
local va_GRC_2020 = "01"
local va_GRC_2021 = "01"
local va_HRV_2015 = "04"
local va_HRV_2018 = "01"
local va_HRV_2019 = "01"
local va_HRV_2020 = "01"
local va_HRV_2021 = "01"
local va_HUN_2015 = "04"
local va_HUN_2018 = "01"
local va_HUN_2019 = "01"
local va_HUN_2020 = "01"
local va_HUN_2021 = "01"
local va_IRL_2015 = "04"
local va_IRL_2018 = "03"
local va_IRL_2019 = "02"
local va_IRL_2020 = "01"
local va_IRL_2021 = "01"
local va_ISL_2015 = "04"
local va_ISL_2018 = "03"
local va_ITA_2015 = "04"
local va_ITA_2018 = "01"
local va_KAZ_2015 = "03"
local va_KAZ_2018 = "01"
local va_KGZ_2015 = "01"
local va_KGZ_2018 = "02"
local va_KGZ_2019 = "01"
local va_KGZ_2020 = "01"
local va_XKX_2014 = "02"
local va_XKX_2017 = "03"
local va_LTU_2015 = "04"
local va_LTU_2018 = "01"
local va_LTU_2019 = "01"
local va_LTU_2020 = "01"
local va_LTU_2021 = "01"
local va_LUX_2015 = "04"
local va_LUX_2018 = "03"
local va_LUX_2019 = "01"
local va_LUX_2020 = "01"
local va_LUX_2021 = "01"
local va_LVA_2015 = "04"
local va_LVA_2018 = "01"
local va_LVA_2019 = "01"
local va_LVA_2020 = "01"
local va_LVA_2021 = "01"
local va_MDA_2015 = "01"
local va_MDA_2018 = "02"
local va_MDA_2019 = "01"
local va_MDA_2021 = "01"
local va_MKD_2015 = "02"
local va_MKD_2018 = "01"
local va_MKD_2019 = "01"
local va_MKD_2020 = "01"
local va_MNE_2014 = "02"
local va_MNE_2017 = "01"
local va_MNE_2018 = "01"
local va_MNE_2019 = "01"
local va_NLD_2015 = "04"
local va_NLD_2018 = "01"
local va_NLD_2019 = "01"
local va_NLD_2020 = "01"
local va_NLD_2021 = "01"
local va_NOR_2015 = "04"
local va_NOR_2018 = "01"
local va_NOR_2019 = "02"
local va_NOR_2020 = "01"
local va_POL_2015 = "03"
local va_POL_2018 = "01"
local va_POL_2019 = "01"
local va_POL_2020 = "01"
local va_PRT_2015 = "05"
local va_PRT_2018 = "03"
local va_PRT_2019 = "01"
local va_PRT_2020 = "01"
local va_PRT_2021 = "01"
local va_ROU_2015 = "04"
local va_ROU_2018 = "01"
local va_ROU_2019 = "01"
local va_ROU_2020 = "01"
local va_ROU_2021 = "01"
local va_RUS_2015 = "05"
local va_RUS_2018 = "01"
local va_RUS_2019 = "01"
local va_RUS_2020 = "01"
local va_SRB_2015 = "04"
local va_SRB_2018 = "02"
local va_SRB_2019 = "01"
local va_SRB_2020 = "01"
local va_SRB_2021 = "01"
local va_SVK_2015 = "04"
local va_SVK_2018 = "04"
local va_SVK_2019 = "01"
local va_SVK_2020 = "01"
local va_SVN_2015 = "04"
local va_SVN_2018 = "01"
local va_SVN_2019 = "01"
local va_SVN_2020 = "01"
local va_SVN_2021 = "01"
local va_SWE_2015 = "04"
local va_SWE_2018 = "01"
local va_SWE_2019 = "01"
local va_SWE_2020 = "01"
local va_SWE_2021 = "01"
local va_TJK_2015 = "02"
local va_TUR_2015 = "01"
local va_TUR_2018 = "02"
local va_TUR_2019 = "01"
local va_UKR_2015 = "01"
local va_UKR_2018 = "01"
local va_UKR_2019 = "01"

* corrections
* Poland
local survey_POL_2018 = "EU-SILC"
local survey_POL_2020 = "EU-SILC"
* Romania
local survey_ROU_2018 = "HBS"
* Rusia
local survey_RUS_2018 = "VNDN"
* Serbia
local survey_SRB_2020 = "EU-SILC"
local survey_SRB_2021 = "EU-SILC"

foreach x in $countries{
	foreach y of local periods_`x'{
		di "country `x' and period `y' data to be processed..."
		dlw, coun(`x') y(`y') t(GMD) mod(ALL) verm(`vm_`x'_`y'') vera(`va_`x'_`y'') sur(`survey_`x'_`y'') clear
		di "country `x' and period `y' data processing succeeded"
		save "$raw_data\gmd\eca\GMD_`x'_`y'.dta", replace
	}
}